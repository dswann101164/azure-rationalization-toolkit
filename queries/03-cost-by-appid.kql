Resources
| extend 
    AppID = tostring(tags.AppID),
    Environment = tostring(tags.Environment),
    CostCenter = tostring(tags.CostCenter)
| where isnotempty(AppID)
| summarize 
    ResourceCount = count(),
    ResourceTypes = make_set(type)
by AppID, Environment, CostCenter
| project 
    AppID,
    Environment,
    CostCenter,
    ResourceCount,
    ResourceTypes
| order by ResourceCount desc
